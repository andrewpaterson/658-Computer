  Sat Feb 17 2024 15:07                                                Page 1


                     ***************************************
                     **      WDC 65C816 Macro Assembler   **
                     **                                   **
                     **     Version 3.49.1- Feb  6 2006    **
                     ***************************************

     1                        STARTUP SECTION
     2                        
     3                        	ORG	$0000
     4 00:0000: 5B           	DB '['
     5                        PROGRESS:	
     6 00:0001: 78 78 78 78  	DB 'xxxx'
     7                        PROGRESS_NMI:		
     8 00:0005: 78 78 78 78  	DB 'xxxx'
     9                        PROGRESS_ABORT:
    10 00:0009: 78 78 78 78  	DB 'xxxxxx'
       00:000D: 78 78 
    11                        PROGRESS_BRK:
    12 00:000F: 78 78 78 78  	DB 'xxxx'
    13                        PROGRESS_COP:
    14 00:0013: 78 78 78     	DB 'xxx'
    15                        ENDPROGRESS:	
    16 00:0016: 5D           	DB ']'
    17                        	
    18                        	ORG $E12B
    19                        RESET:
    20 00:E12B: 18           	CLC	     		;clear carry
    21 00:E12C: FB           	XCE	     		;clear emulation
    22 00:E12D: C2 30        	REP		#$30    ;16 bit registers
    23                        	LONGI 	ON
    24                        	LONGA	ON
    25 00:E12F: A9 FF 01     	LDA		#$01FF  ;get the stack address
    26 00:E132: 1B           	TCS	     		;and set the stack to it
    27                        
    28                        
    29 00:E133: E2 20        	SEP		#$20	;8 bit accumulator
    30                        	LONGA 	OFF
    31 00:E135: A9 00        	LDA 	#$00	;get bank of data
    32 00:E137: 48           	PHA
    33 00:E138: AB           	PLB	     		;set data bank register
    34 00:E139: C2 20        	REP		#$20    ;back to 16 bit mode
    35                        	LONGA	ON
    36                        
    37 00:E13B: 5C 00 40 00  	JML  	START	;long jump in case not bank 0
    38                        
    39                        IRQ:
    40 00:E13F: 8B           	PHB				;save DB
    41 00:E140: 0B           	PHD				;save DP
    42 00:E141: C2 30        	REP		#$30	;16 bit registers
    43                        	LONGI 	ON
    44                        	LONGA	ON
    45 00:E143: 48           	PHA				;save A
    46 00:E144: DA           	PHX				;save X
    47 00:E145: 5A           	PHY 			;save Y
    48                        	
    49 00:E146: A2 2E 40     	LDX 	#IRQ_STRING
    50 00:E149: A0 01 00     	LDY 	#PROGRESS
    51 00:E14C: 20 1D 40     	JSR 	WRITE_STRING
  Sat Feb 17 2024 15:07                                                Page 2


    52                        	
    53 00:E14F: 80 57        	BRA 	EXIT_INTERRUPT 
    54                        
    55                        NMI:
    56 00:E151: 8B           	PHB				;save DB
    57 00:E152: 0B           	PHD				;save DP
    58 00:E153: C2 30        	REP		#$30	;16 bit registers
    59                        	LONGI 	ON
    60                        	LONGA	ON
    61 00:E155: 48           	PHA				;save A
    62 00:E156: DA           	PHX				;save X
    63 00:E157: 5A           	PHY 			;save Y
    64                        
    65 00:E158: A2 32 40     	LDX 	#NMI_STRING
    66 00:E15B: A0 05 00     	LDY 	#PROGRESS_NMI
    67 00:E15E: 20 1D 40     	JSR 	WRITE_STRING
    68                        	
    69 00:E161: 80 45        	BRA 	EXIT_INTERRUPT 
    70                        
    71                        ABORT:
    72 00:E163: 8B           	PHB				;save DB
    73 00:E164: 0B           	PHD				;save DP
    74 00:E165: C2 30        	REP		#$30	;16 bit registers
    75                        	LONGI 	ON
    76                        	LONGA	ON
    77 00:E167: 48           	PHA				;save A
    78 00:E168: DA           	PHX				;save X
    79 00:E169: 5A           	PHY 			;save Y
    80                        	
    81 00:E16A: A2 36 40     	LDX 	#ABORT_STRING
    82 00:E16D: A0 09 00     	LDY 	#PROGRESS_ABORT
    83 00:E170: 20 1D 40     	JSR 	WRITE_STRING
    84                        
    85 00:E173: 80 33        	BRA 	EXIT_INTERRUPT 
    86                        
    87                        COP:
    88 00:E175: 8B           	PHB				;save DB
    89 00:E176: 0B           	PHD				;save DP
    90 00:E177: C2 30        	REP		#$30	;16 bit registers
    91                        	LONGI 	ON
    92                        	LONGA	ON
    93 00:E179: 48           	PHA				;save A
    94 00:E17A: DA           	PHX				;save X
    95 00:E17B: 5A           	PHY 			;save Y
    96                        
    97 00:E17C: A2 40 40     	LDX 	#COP_STRING
    98 00:E17F: A0 13 00     	LDY 	#PROGRESS_COP
    99 00:E182: 20 1D 40     	JSR 	WRITE_STRING
   100                        	
   101 00:E185: 80 21        	BRA 	EXIT_INTERRUPT 
   102                        
   103                        BRK:
   104 00:E187: 8B           	PHB				;save DB
   105 00:E188: 0B           	PHD				;save DP
   106 00:E189: C2 30        	REP		#$30	;16 bit registers
   107                        	LONGI 	ON
   108                        	LONGA	ON
   109 00:E18B: 48           	PHA				;save A
  Sat Feb 17 2024 15:07                                                Page 3


   110 00:E18C: DA           	PHX				;save X
   111 00:E18D: 5A           	PHY 			;save Y
   112                        
   113 00:E18E: A2 3C 40     	LDX 	#BRK_STRING
   114 00:E191: A0 0F 00     	LDY 	#PROGRESS_BRK
   115 00:E194: 20 1D 40     	JSR 	WRITE_STRING
   116                        	
   117 00:E197: 80 0F        	BRA 	EXIT_INTERRUPT 
   118                        
   119                        EMU:
   120 00:E199: 8B           	PHB				;save DB
   121 00:E19A: 0B           	PHD				;save DP
   122 00:E19B: C2 30        	REP		#$30	;16 bit registers
   123                        	LONGI 	ON
   124                        	LONGA	ON
   125 00:E19D: 48           	PHA				;save A
   126 00:E19E: DA           	PHX				;save X
   127 00:E19F: 5A           	PHY 			;save Y
   128                        	
   129 00:E1A0: A9 45 00     	LDA 	#"E"
   130 00:E1A3: 20 0E 40     	JSR 	WRITE_PROGRESS
   131                        
   132 00:E1A6: 80 00        	BRA 	EXIT_INTERRUPT 
   133                        
   134                        EXIT_INTERRUPT:
   135 00:E1A8: C2 30        	REP		#$30	;16 bit registers
   136                        	LONGI 	ON
   137                        	LONGA	ON
   138 00:E1AA: 7A           	PLY             ;restore Y
   139 00:E1AB: FA               PLX             ;restore X
   140 00:E1AC: 68               PLA             ;restore A
   141 00:E1AD: 2B               PLD             ;restore DP
   142 00:E1AE: AB               PLB             ;restore DB
   143 00:E1AF: 40           	RTI
   144                        	
   145                        ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                    ;;;;;;;;;;;;;;;;;;;;;;;	
   146                        	
   147                        	ORG $4000
   148                        START:
   149 00:4000: 58           	CLI
   150 00:4001: A9 2E 00     	LDA 	#"."
   151 00:4004: 20 0E 40     	JSR 	WRITE_PROGRESS
   152 00:4007: 00 0C        	BRK		12
   153 00:4009: 02 22        	COP		34
   154                        	
   155                        LOOP:
   156 00:400B: 4C 00 40     	JMP 	START
   157                        
   158                        WRITE_PROGRESS:
   159 00:400E: E2 20        	SEP		#$20	;8 bit accumulator
   160                        	LONGA 	OFF
   161                        
   162 00:4010: A0 01 00     	LDY 	#PROGRESS
   163                        LOOP_DOT:	
   164 00:4013: 99 00 00     	STA 	0,Y
   165 00:4016: C8           	INY
   166 00:4017: C0 16 00     	CPY 	#ENDPROGRESS
  Sat Feb 17 2024 15:07                                                Page 4


   167 00:401A: D0 F7        	BNE 	LOOP_DOT
   168 00:401C: 60           	RTS
   169                        	
   170                        WRITE_STRING:	
   171 00:401D: E2 20        	SEP		#$20	;8 bit accumulator
   172                        	LONGA 	OFF
   173                        WRITE_STRING_LOOP:	
   174 00:401F: BD 00 00     	LDA 	0,X
   175 00:4022: F0 07        	BEQ 	DONE_STRING
   176 00:4024: 99 00 00     	STA 	0,Y
   177 00:4027: C8           	INY
   178 00:4028: E8           	INX
   179 00:4029: 80 F4        	BRA 	WRITE_STRING_LOOP
   180                        DONE_STRING:
   181 00:402B: C2 20        	REP		#$20    ;back to 16 bit mode
   182                        	LONGA 	ON
   183 00:402D: 60           	RTS
   184                        
   185                        IRQ_STRING:	
   186 00:402E: 49 52 51     	DB 'IRQ'
   187 00:4031: 00           	DB #0
   188                        NMI_STRING:	
   189 00:4032: 4E 4D 49     	DB 'NMI'
   190 00:4035: 00           	DB #0
   191                        ABORT_STRING:	
   192 00:4036: 41 42 4F 52  	DB 'ABORT'
       00:403A: 54 
   193 00:403B: 00           	DB #0
   194                        BRK_STRING:	
   195 00:403C: 42 52 4B     	DB 'BRK'
   196 00:403F: 00           	DB #0
   197                        COP_STRING:	
   198 00:4040: 43 4F 50     	DB 'COP'
   199 00:4043: 00           	DB #0
   200                        EMULATION_STRING:	
   201 00:4044: 20 2D 20 45  	DB ' - Emulation -  '
       00:4048: 6D 75 6C 61 
       00:404C: 74 69 6F 6E 
       00:4050: 20 2D 20 20 
   202 00:4054: 00           	DB #0
   203                        
   204                        	
   205                        ; This section defines the interrupt and reset vec
                    tors.    
   206                        
   207                        	ORG	$FFE4
   208                        
   209 00:FFE4: 75 E1        N_COP   DW    COP
   210 00:FFE6: 87 E1        N_BRK   DW    BRK
   211 00:FFE8: 63 E1        N_ABORT DW    ABORT
   212 00:FFEA: 51 E1        N_NMI   DW    NMI
   213 00:FFEC: 00 00        N_RSRVD DW    0
   214 00:FFEE: 3F E1        N_IRQ   DW    IRQ
   215 00:FFF0:              	DS    4
   216 00:FFF4: 99 E1        E_COP   DW    EMU
   217 00:FFF6: 00 00        E_RSRVD DW    0
   218 00:FFF8: 99 E1        E_ABORT DW    EMU
   219 00:FFFA: 99 E1        E_NMI   DW    EMU
  Sat Feb 17 2024 15:07                                                Page 5


   220 00:FFFC: 2B E1        E_RESET DW    RESET
   221 00:FFFE: 99 E1        E_IRQ   DW    EMU
   222                        
   223 01:0000:              	ENDS
   224                        	END


      Lines assembled: 224
      Errors: 0
